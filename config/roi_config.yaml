# Urban Drainage Inference - Region of Interest & System Configuration
# FINAL RELEASE CONFIGURATION

# -----------------------------------------------------------------------------
# REGION OF INTEREST (ROI)
# -----------------------------------------------------------------------------
roi:
  city_name: "Seattle, WA"
  crs: "EPSG:4326"
  # Define EITHER boundary_file OR bounds
  boundary_file: null
  bounds:
    lon_min: -122.42
    lat_min: 47.50
    lon_max: -122.24
    lat_max: 47.74
  
  max_area_sq_km: 50000.0
  min_area_sq_km: 1.0
  buffer_degrees: 0.05

# -----------------------------------------------------------------------------
# DATA PARAMETERS
# -----------------------------------------------------------------------------
rainfall:
  gauge_min_coverage: 0.75
  radar_bias_correction: true
  temporal_resolution_minutes: 15
  accumulation_window_hours: 6
  intensity_threshold_mm_hr: 10.0

complaints:
  min_fields_required:
    - "timestamp"
    - "latitude"
    - "longitude"
    - "complaint_type"
  deduplicate_minutes: 60
  geo_epsilon_meters: 75.0
  spatial_uncertainty_radius_m: 300.0
  delay_prior_mean_hours: 2.0
  delay_prior_sd_hours: 1.5
  max_delay_hours: 48.0
  time_aggregation_minutes: 60

terrain:
  dem_resolution_meters: 10.0
  fill_sinks: true
  slope_threshold_degrees: 0.5
  sink_fill_max_depth_m: 0.5
  slope_smooth_kernel: 3
  spike_zscore_threshold: 6.0
  flat_slope_threshold: 0.1
  accumulation_confidence_floor: 0.4

# -----------------------------------------------------------------------------
# MODEL PARAMETERS
# -----------------------------------------------------------------------------
latent_model:
  spatial_corr_length_m: 1000.0
  temporal_corr_minutes: 30
  prior_stress_mean: 0.0
  prior_stress_sd: 1.0
  observation_noise_sd: 0.5
  weight_intensity: 1.0
  weight_accumulation: 0.4
  weight_upstream: 0.8
  intercept: 0.0
  memory_decay: 0.35
  variance_floor: 1.0e-4
  missing_data_tolerance: 0.7
  upstream_confidence_floor: 0.5
  missing_variance_inflation: 2.0

observation_model:
  base_reporting_prob: 0.3
  min_reporting_prob: 0.01
  max_reporting_prob: 0.95
  delay_mean_hours: 2.0
  delay_sd_hours: 1.5
  delay_max_hours: 48.0
  rate_floor: 1.0e-6
  coverage_threshold: 0.05

# -----------------------------------------------------------------------------
# INFERENCE & OUTPUTS
# -----------------------------------------------------------------------------
inference:
  cred_interval: 0.9
  min_event_duration_minutes: 30
  anomaly_zscore: 2.0
  posterior_variance_floor: 1.0e-6

validation:
  rain_extreme_quantile: 0.9
  lead_time_threshold_minutes: 120
  stress_jump_zscore: 3.0
  low_lying_quantile: 0.2
  overconfident_threshold: 0.1
  underconfident_threshold: 0.5
  stress_collapse_factor: 0.2
  terrain_shuffle_drop: 0.2

outputs:
  high_risk_threshold: 0.8
  medium_risk_threshold: 0.5
  uncertainty_high: 0.4
  uncertainty_low: 0.1
  crs: "EPSG:4326"
  driver: "GeoJSON"
  html_max_points: 5000
  snapshot_times:
    - "pre"
    - "peak"
    - "post"
